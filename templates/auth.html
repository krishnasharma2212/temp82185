<!DOCTYPE html>
<html class="light" lang="de">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <!-- SEO (DE) -->
    <title>Realistix Doll® – Mitgliederzugang | Privater Login</title>
    <meta name="description"
        content="Sicherer Mitglieder-Login bei Realistix Doll®. Greifen Sie auf Ihre private Wunschliste, persönliche Bestellungen und exklusive Kollektionen zu. Diskreter Versand, SSL-verschlüsselt." />
    <meta name="keywords"
        content="Realistix Doll Login, Mitgliederzugang, private Kollektion, realistische Puppen, individuelle Puppen, diskreter Versand, Login Deutschland" />
    <meta name="author" content="Realistix Doll S.A." />
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
    <meta http-equiv="content-language" content="de" />

    <!-- GEO / LOCALE -->
    <meta name="geo.region" content="DE" />
    <meta name="geo.placename" content="Deutschland" />

    <!-- CANONICAL + HREFLANG (DE only) -->
    <link rel="canonical" href="https://www.realistixdoll.com/auth" />
    <link rel="alternate" hreflang="de" href="https://www.realistixdoll.com/auth" />

    <!-- Open Graph (DE) -->
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="de_DE" />
    <meta property="og:title" content="Realistix Doll® – Mitgliederzugang | Privater Login" />
    <meta property="og:description"
        content="Loggen Sie sich sicher in Ihr Realistix Doll® Mitgliederkonto ein. Verwalten Sie Wunschlisten, individuelle Bestellungen und exklusive Kollektionen – diskret und verschlüsselt." />
    <meta property="og:url" content="https://www.realistixdoll.com/auth" />
    <meta property="og:site_name" content="Realistix Doll®" />
    <meta property="og:image" content="https://www.realistixdoll.com/static/og/realistix-login-de.jpg" />
    <meta property="og:image:alt" content="Realistix Doll – Diskreter Login für Mitglieder" />

    <!-- Twitter Card (DE) -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Realistix Doll® – Mitgliederzugang" />
    <meta name="twitter:description"
        content="Sicherer Mitglieder-Login: Zugriff auf Wunschlisten, persönliche Bestellungen und exklusive Kollektionen. Diskret & SSL-verschlüsselt." />
    <meta name="twitter:image" content="https://www.realistixdoll.com/static/og/realistix-login-de.jpg" />

    <!-- PWA / Mobile / Trust -->
    <meta name="theme-color" content="#20cfdf" />
    <meta name="application-name" content="Realistix Doll" />
    <meta name="apple-mobile-web-app-title" content="Realistix Doll" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <!-- Structured Data (Organization, DE) -->
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Realistix Doll S.A.",
  "url": "https://www.realistixdoll.com",
  "logo": "https://www.realistixdoll.com/static/icons/favicon-96x96.png",
  "sameAs": [],
  "description": "Realistix Doll – Premium realistische Puppen. Diskreter Versand und individueller Kundenservice für Mitglieder."
}
</script>


    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="icon" type="image/png" href="/static/icons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/static/icons/favicon.svg" />
    <link rel="shortcut icon" href="/static/icons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/static/icons/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Realistix Doll" />
    <link rel="manifest" href="/static/icons/site.webmanifest" />


    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,600;0,700;1,500&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />

    <script id="tailwind-config">
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        "primary": "#20cfdf",
                        "primary-dark": "#18a0ac",
                        "dark-surface": "#0f172a",
                    },
                    fontFamily: {
                        "sans": ["Inter", "sans-serif"],
                        "serif": ["Playfair Display", "serif"],
                    },
                    animation: {
                        'slide-in-right': 'slideInRight 0.4s cubic-bezier(0.16, 1, 0.3, 1)',
                        'fade-out': 'fadeOut 0.4s ease-in forwards',
                    },
                    keyframes: {
                        slideInRight: {
                            '0%': { transform: 'translateX(100%)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' },
                        },
                        fadeOut: {
                            '0%': { opacity: '1' },
                            '100%': { opacity: '0' },
                        }
                    }
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* Floating Input Labels */
        .floating-input:focus~label,
        .floating-input:not(:placeholder-shown)~label {
            top: -0.6rem;
            left: 0.8rem;
            font-size: 0.75rem;
            color: #20cfdf;
            background-color: white;
            padding: 0 0.4rem;
            font-weight: 600;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4 relative overflow-hidden">

    <!-- TOAST CONTAINER (Fixed) -->
    <div id="toast-container" class="fixed top-5 right-5 z-[60] flex flex-col gap-3 pointer-events-none"></div>

    <!-- Background Ambience -->
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
        <div class="absolute top-[-10%] right-[-5%] w-[600px] h-[600px] bg-primary/10 rounded-full blur-[120px]"></div>
        <div class="absolute bottom-[-10%] left-[-5%] w-[600px] h-[600px] bg-pink-500/5 rounded-full blur-[120px]">
        </div>
    </div>

    <!-- Main Card -->
    <main
        class="bg-white w-full max-w-[1100px] rounded-3xl shadow-2xl overflow-hidden grid grid-cols-1 lg:grid-cols-2 relative z-10 min-h-[700px] border border-gray-100">

        <!-- LEFT: Visual Experience -->
        <div class="hidden lg:flex flex-col justify-between relative bg-black text-white p-12 overflow-hidden group">
            <div class="absolute inset-0 transition-transform duration-[3s] ease-out group-hover:scale-105">
                <!-- Sensual/Premium Image Placeholder -->
                <img src="https://res.cloudinary.com/dwfwnyrvh/image/upload/q_auto:best/v1768153789/downloaded_images/1P8A4505_50775885.webp"
                    class="w-full h-full object-cover opacity-70 grayscale hover:grayscale-0 transition-all duration-1000"
                    alt="Realistix Doll Artisan">
                <div class="absolute inset-0 bg-gradient-to-t from-black via-black/30 to-transparent"></div>
            </div>

            <!-- Logo -->
            <div class="relative z-10 flex items-center gap-2">
                <img src="/static/icons/favicon.svg" style="height: 40px;" alt="Realistix Doll">
                <span class="text-xl font-bold tracking-[0.2em] uppercase font-serif">Realistix Doll</span>
            </div>

            <!-- Quote -->
            <div class="relative z-10 space-y-4">
                <div class="h-px w-12 bg-primary"></div>
                <blockquote class="font-serif text-3xl italic leading-tight text-gray-100">
                    "Intimität neu definiert. <br>Perfektion verwirklicht.“
                </blockquote>
                <p class="text-xs font-bold uppercase tracking-widest text-primary/80">Die private Kollektion</p>
            </div>

        </div>

        <!-- RIGHT: Forms -->
        <div class="flex flex-col justify-center p-8 md:p-12 lg:p-16 bg-white relative">

            <!-- Mobile Logo -->
            <div class="lg:hidden flex justify-center mb-6 text-primary">
                <img src="/static/icons/favicon.svg" style="height: 40px;" alt="Realistix Doll">
            </div>

            <div id="auth-container" class="max-w-md mx-auto w-full transition-opacity duration-300">

                <!-- Dynamic Header -->
                <div class="text-center mb-8">
                    <h2 id="page-title" class="font-serif text-4xl font-bold text-gray-900 mb-2">
                        Willkommen zurück
                    </h2>
                    <p id="page-subtitle" class="text-gray-500 text-sm">
                        Greifen Sie auf Ihre private Wunschliste und individuellen Bestellungen zu.
                    </p>
                </div>

                <!-- Social Buttons -->
                <div class="space-y-3 mb-8">
                    <button id="google-btn"
                        class="w-full flex items-center justify-center gap-3 px-4 py-3.5 border border-gray-200 rounded-xl font-medium text-gray-700 hover:bg-gray-50 hover:border-gray-300 transition-all bg-white relative overflow-hidden group">
                        <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="size-5 relative z-10"
                            alt="Google">
                        <span class="relative z-10">Mit Google fortfahren</span>
                    </button>

                    <button id="apple-btn"
                        class="w-full flex items-center justify-center gap-3 px-4 py-3.5 bg-black text-white rounded-xl font-medium hover:bg-gray-800 transition-all shadow-lg shadow-gray-200">
                        <svg class="size-5 fill-current" viewBox="0 0 24 24">
                            <path
                                d="M17.05 20.28c-.98.95-2.05.88-3.08.4-1.09-.5-2.08-.48-3.24 0-1.44.62-2.2.44-3.06-.4C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.74.79 0 2.22-.71 3.73-.62 1.25.07 2.37.6 3.03 1.55-2.73 1.57-2.3 5.43.37 6.64-.53 1.62-1.34 3.2-2.21 4.66zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.54 4.5-3.74 4.25z" />
                        </svg>
                        <span>Mit Apple fortfahren</span>
                    </button>
                </div>

                <div class="relative flex items-center gap-4 mb-8 opacity-60">
                    <div class="h-px bg-gray-300 flex-1"></div>
                    <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">
                        Oder per sicherer E-Mail
                    </span>
                    <div class="h-px bg-gray-300 flex-1"></div>
                </div>

                <!-- LOGIN FORM -->
                <form id="login-form" class="space-y-6">
                    <div class="relative">
                        <input type="email" id="login-email" placeholder=" "
                            class="floating-input peer w-full px-4 py-3.5 rounded-xl border border-gray-200 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all bg-white text-gray-900 placeholder-transparent">
                        <label for="login-email"
                            class="absolute left-4 top-3.5 text-gray-400 text-sm transition-all pointer-events-none">
                            E-Mail-Adresse
                        </label>
                    </div>

                    <div class="relative">
                        <input type="password" id="login-pass" placeholder=" "
                            class="floating-input peer w-full px-4 py-3.5 rounded-xl border border-gray-200 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all bg-white text-gray-900 placeholder-transparent">
                        <label for="login-pass"
                            class="absolute left-4 top-3.5 text-gray-400 text-sm transition-all pointer-events-none">
                            Passwort
                        </label>
                        <button type="button" onclick="togglePassword('login-pass', this)"
                            class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-primary transition-colors">
                            <span class="material-symbols-outlined text-xl">visibility</span>
                        </button>
                    </div>

                    <div class="flex justify-between items-center text-sm">
                        <label class="flex items-center gap-2 cursor-pointer group">
                            <input type="checkbox"
                                class="rounded border-gray-300 text-primary focus:ring-primary cursor-pointer">
                            <span class="text-gray-500 group-hover:text-gray-700">
                                Angemeldet bleiben
                            </span>
                        </label>
                    </div>

                    <button type="submit" id="btn-login-submit"
                        class="group relative w-full bg-primary hover:bg-primary-dark text-white font-bold py-4 rounded-xl shadow-lg shadow-primary/20 transition-all hover:scale-[1.01] active:scale-[0.98] overflow-hidden">
                        <span class="relative z-10 flex items-center justify-center gap-2">
                            <span>Sicher anmelden</span>
                            <span
                                class="material-symbols-outlined text-sm group-hover:translate-x-1 transition-transform">
                                arrow_forward
                            </span>
                        </span>
                    </button>
                </form>


                <!-- SIGNUP FORM -->
                <form id="signup-form" class="hidden space-y-6">
                    <div class="relative">
                        <input type="text" id="signup-name" placeholder=" "
                            class="floating-input peer w-full px-4 py-3.5 rounded-xl border border-gray-200 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all bg-white text-gray-900 placeholder-transparent">
                        <label for="signup-name"
                            class="absolute left-4 top-3.5 text-gray-400 text-sm transition-all pointer-events-none">
                            Vollständiger Name
                        </label>
                    </div>

                    <div class="relative">
                        <input type="email" id="signup-email" placeholder=" "
                            class="floating-input peer w-full px-4 py-3.5 rounded-xl border border-gray-200 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all bg-white text-gray-900 placeholder-transparent">
                        <label for="signup-email"
                            class="absolute left-4 top-3.5 text-gray-400 text-sm transition-all pointer-events-none">
                            E-Mail-Adresse
                        </label>
                    </div>

                    <div class="relative">
                        <input type="password" id="signup-pass" placeholder=" "
                            class="floating-input peer w-full px-4 py-3.5 rounded-xl border border-gray-200 focus:border-primary focus:ring-1 focus:ring-primary focus:outline-none transition-all bg-white text-gray-900 placeholder-transparent">
                        <label for="signup-pass"
                            class="absolute left-4 top-3.5 text-gray-400 text-sm transition-all pointer-events-none">
                            Passwort erstellen
                        </label>
                        <button type="button" onclick="togglePassword('signup-pass', this)"
                            class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-primary transition-colors">
                            <span class="material-symbols-outlined text-xl">visibility</span>
                        </button>
                    </div>

                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-100 flex items-start gap-3">
                        <span class="material-symbols-outlined text-primary mt-0.5 text-lg">local_shipping</span>
                        <div class="text-xs text-gray-500 leading-relaxed">
                            Wir garantieren <strong>100 % neutrale und diskrete Verpackung</strong>
                            auf allen Rechnungen und bei allen Lieferungen.
                        </div>
                    </div>

                    <button type="submit" id="btn-signup-submit"
                        class="group relative w-full bg-primary hover:bg-primary-dark text-white font-bold py-4 rounded-xl shadow-lg shadow-primary/20 transition-all hover:scale-[1.01] active:scale-[0.98]">
                        <span class="relative z-10">
                            Privates Konto erstellen
                        </span>
                    </button>
                </form>

                <!-- Toggle -->
                <div class="mt-8 text-center border-t border-gray-100 pt-6">
                    <p id="toggle-text" class="text-gray-500 text-sm">
                        Neu bei Realistix Doll?
                        <button onclick="toggleAuth(true)"
                            class="text-primary font-bold hover:underline transition-all ml-1">
                            Dem Inner Circle beitreten
                        </button>
                    </p>
                </div>

            </div>
        </div>
    </main>
<!-- === MODERN FOOTER === -->
<footer class="bg-slate-900 text-slate-300 border-t border-slate-800 pt-16 pb-8 font-sans">
        <div class="max-w-[1440px] mx-auto px-6 lg:px-20">

            <!-- Top Grid: Brand, Links, Contact -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-16">

                <!-- 1. Brand & Promise -->
                <div class="space-y-6">
                    <a href="/" class="flex items-center gap-3 group">
                        <div
                            class="size-10 bg-white/5 rounded-xl flex items-center justify-center border border-white/10 group-hover:border-primary/50 transition-colors">
                            <img src="/static/icons/favicon.svg" alt="Realistix" class="size-6 opacity-90">
                        </div>
                        <span class="text-xl font-black text-white tracking-tight font-serif">Realistix Doll</span>
                    </a>
                    <p class="text-sm text-slate-400 leading-relaxed">
                        Handgefertigte TPE- & Silikonkunstwerke. Wir verbinden europäische Design-Standards mit
                        meisterhafter Handwerkskunst für unvergleichlichen Realismus.
                    </p>
                    <div class="flex items-center gap-4 pt-2">
                        <div
                            class="flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 text-[10px] font-bold uppercase tracking-wider">
                            <span class="material-symbols-outlined text-sm">verified_user</span>
                            Verifizierter Shop
                        </div>
                    </div>
                </div>

                <!-- 2. Customer Care -->
                <div>
                    <h4 class="text-white font-bold mb-6 flex items-center gap-2">
                        <span class="w-1 h-4 bg-primary rounded-full"></span>
                        Service & Hilfe
                    </h4>
                    <ul class="space-y-3 text-sm">
                        <li><a href="/my-orders"
                                class="hover:text-primary transition-colors flex items-center gap-2"><span
                                    class="material-symbols-outlined text-xs opacity-50">chevron_right</span> Meine
                                Bestellungen</a></li>
                    </ul>
                </div>

                <!-- 3. Legal (Rechtliches) -->
                <div>
                    <h4 class="text-white font-bold mb-6 flex items-center gap-2">
                        <span class="w-1 h-4 bg-primary rounded-full"></span>
                        Rechtliches
                    </h4>
                    <ul class="space-y-3 text-sm">
                        <li><a href="/impressum"
                                class="hover:text-primary transition-colors flex items-center gap-2"><span
                                    class="material-symbols-outlined text-xs opacity-50">gavel</span> Impressum</a></li>
                        <li><a href="/datenschutz"
                                class="hover:text-primary transition-colors flex items-center gap-2"><span
                                    class="material-symbols-outlined text-xs opacity-50">policy</span>
                                Datenschutzerklärung</a></li>
                        <li><a href="/agb" class="hover:text-primary transition-colors flex items-center gap-2"><span
                                    class="material-symbols-outlined text-xs opacity-50">description</span> AGB</a></li>
                        <li><a href="/widerruf"
                                class="hover:text-primary transition-colors flex items-center gap-2"><span
                                    class="material-symbols-outlined text-xs opacity-50">undo</span> Widerrufsrecht</a>
                        </li>
                    </ul>
                </div>

                <!-- 4. Contact & HQ (Transparent Indian Address) -->
                <div>
                    <h4 class="text-white font-bold mb-6 flex items-center gap-2">
                        <span class="w-1 h-4 bg-primary rounded-full"></span>
                        Atelier & Kontakt
                    </h4>
                    <div class="space-y-4 text-sm text-slate-400">
                        <div class="flex items-start gap-3">
                            <span class="material-symbols-outlined text-primary mt-0.5">location_on</span>
                            <div>
                                <strong class="text-slate-200 block">Realistix Doll HQ</strong>
                                <span class="block">Connaught Place</span>
                                <span class="block">110001 New Delhi, Indien</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-primary">mail</span>
                            <a href="mailto:support@realistixdoll.com"
                                class="hover:text-white transition-colors">support@realistixdoll.com</a>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-primary">call</span>
                            <span>+91 98765 43210</span>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Middle: Trust & Payment Bar -->
            <div class="border-t border-slate-800 py-8 flex flex-col md:flex-row justify-between items-center gap-6">

                <!-- Secure Payment -->
                <div class="flex flex-col items-center md:items-start gap-3">
                    <span class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Sichere Zahlung</span>
                    <div
                        class="flex items-center gap-3 opacity-80 grayscale hover:grayscale-0 transition-all duration-500">
                        <!-- Using generic SVGs or hosted logos for professionalism -->
                        <img src="/static/wise.png"
                            class="h-12 w-auto bg-white rounded px-1" alt="Wise">
                        <img src="/static/revolut.png"
                            class="h-12 w-auto bg-white rounded px-1" alt="Revolut">
                        <img src="/static/worldremit.png"
                            class="h-12 w-auto bg-white rounded px-1" alt="Visa">
                        <img src="/static/remitly.png"
                            class="h-12 w-auto bg-white rounded px-1" alt="Mastercard">
                    </div>
                </div>

                <!-- Global Shipping -->
                <div class="flex flex-col items-center md:items-end gap-3">
                    <span class="text-[10px] font-bold uppercase tracking-widest text-slate-500">Logistikpartner</span>
                    <div
                        class="flex items-center gap-3 opacity-80 grayscale hover:grayscale-0 transition-all duration-500">
                        <img src="https://cdn.worldvectorlogo.com/logos/dhl-1.svg"
                            class="h-12 w-auto bg-white rounded px-1" alt="DHL">
                        <img src="https://cdn.worldvectorlogo.com/logos/fedex-express-6.svg"
                            class="h-12 w-auto bg-white rounded px-1" alt="FedEx">
                    </div>
                </div>

            </div>

            <!-- Bottom: Copyright & Disclaimer -->
            <div
                class="border-t border-slate-800 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-slate-500">
                <p>
                    &copy; 2026 Realistix Doll S.A. Alle Rechte vorbehalten.
                    <span class="hidden md:inline mx-2 text-slate-700">|</span>
                    Operated by Rahul Sharma Enterprises, India.
                </p>
                <div class="flex items-center gap-4">
                    <span class="flex items-center gap-1"><span
                            class="material-symbols-outlined text-[14px]">lock</span> SSL Verschlüsselt</span>
                    <span class="flex items-center gap-1"><span
                            class="material-symbols-outlined text-[14px]">public</span> Globaler Versand</span>
                </div>
            </div>

        </div>
    </footer>

    <!-- LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signInWithPopup,
            GoogleAuthProvider,
            OAuthProvider,
            updateProfile
        } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // --- FIREBASE CONFIG (Replace with yours) ---
        const firebaseConfig = {
  apiKey: "AIzaSyAf1cpih22DLVpo9umzhLeJWi59pcQwhUQ",
  authDomain: "realistixdoll.firebaseapp.com",
  projectId: "realistixdoll",
  storageBucket: "realistixdoll.firebasestorage.app",
  messagingSenderId: "797964056076",
  appId: "1:797964056076:web:6deb911bda83372109e029",
  measurementId: "G-1GBMKJEV3L"
};


        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const googleProvider = new GoogleAuthProvider();
        const appleProvider = new OAuthProvider('apple.com');
        appleProvider.addScope('email');
        appleProvider.addScope('name');

        // --- UI UTILITIES ---

        // Toast Notification System
        function showToast(message, type = 'error') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');

            // Colors
            const bgClass = type === 'success' ? 'bg-emerald-500' : 'bg-rose-500';
            const icon = type === 'success' ? 'check_circle' : 'error';

            toast.className = `${bgClass} text-white px-6 py-4 rounded-xl shadow-2xl flex items-center gap-3 animate-slide-in-right pointer-events-auto min-w-[300px]`;
            toast.innerHTML = `
                <span class="material-symbols-outlined text-xl bg-white/20 p-1 rounded-full">${icon}</span>
                <span class="font-medium text-sm">${message}</span>
            `;

            container.appendChild(toast);

            // Remove after 4 seconds
            setTimeout(() => {
                toast.classList.add('animate-fade-out');
                setTimeout(() => toast.remove(), 400);
            }, 4000);
        }

        // Friendly Error Mapper
        function getFriendlyErrorMessage(errorCode) {
            switch (errorCode) {
                case 'auth/invalid-email': return 'Bitte geben Sie eine gültige E-Mail-Adresse ein.';
                case 'auth/user-disabled': return 'Dieses Konto wurde deaktiviert.';
                case 'auth/user-not-found': return 'Es wurde kein Konto mit dieser E-Mail-Adresse gefunden.';
                case 'auth/wrong-password': return 'Falsches Passwort. Bitte versuchen Sie es erneut.';
                case 'auth/email-already-in-use': return 'Diese E-Mail-Adresse ist bereits registriert. Bitte melden Sie sich an.';
                case 'auth/weak-password': return 'Das Passwort muss mindestens 6 Zeichen lang sein.';
                case 'auth/popup-closed-by-user': return 'Anmeldung abgebrochen.';
                default: return 'Ein unerwarteter Fehler ist aufgetreten. Bitte versuchen Sie es erneut.';
            }
        }


        // Button Loading State
        function setLoading(btnId, isLoading, originalText) {
            const btn = document.getElementById(btnId);
            if (isLoading) {
                btn.disabled = true;
                btn.innerHTML = `<svg class="animate-spin h-5 w-5 text-white mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>`;
                btn.classList.add('opacity-80', 'cursor-not-allowed');
            } else {
                btn.disabled = false;
                btn.innerHTML = originalText;
                btn.classList.remove('opacity-80', 'cursor-not-allowed');
            }
        }

        // --- VIEW LOGIC ---

        // Expose toggle globally
        window.toggleAuth = function (showSignup) {
            const loginForm = document.getElementById('login-form');
            const signupForm = document.getElementById('signup-form');
            const title = document.getElementById('page-title');
            const subtitle = document.getElementById('page-subtitle');
            const toggleText = document.getElementById('toggle-text');
            const container = document.getElementById('auth-container');

            // Fade transition
            container.style.opacity = '0';

            setTimeout(() => {
                if (showSignup) {
                    // Show Signup
                    loginForm.classList.add('hidden');
                    signupForm.classList.remove('hidden');
                    title.innerText = "Dem Club beitreten";
                    subtitle.innerText = "Erstellen Sie ein privates Konto, um Ihre Puppe individuell anzupassen.";
                    toggleText.innerHTML = `Bereits Mitglied?
            <button onclick="toggleAuth(false)"
                class="text-primary font-bold hover:underline transition-all ml-1">
                Zum Konto
            </button>`;

                    // Update URL without reload
                    const url = new URL(window.location);
                    url.searchParams.set('type', 'signup');
                    window.history.pushState({}, '', url);
                } else {
                    // Show Login
                    loginForm.classList.remove('hidden');
                    signupForm.classList.add('hidden');
                    title.innerText = "Willkommen zurück";
                    subtitle.innerText = "Greifen Sie auf Ihre private Wunschliste und individuellen Bestellungen zu.";
                    toggleText.innerHTML = `Neu bei Realistix Doll?
            <button onclick="toggleAuth(true)"
                class="text-primary font-bold hover:underline transition-all ml-1">
                Dem Inner Circle beitreten
            </button>`;

                    // Update URL without reload
                    const url = new URL(window.location);
                    url.searchParams.set('type', 'signin');
                    window.history.pushState({}, '', url);
                }
                container.style.opacity = '1';
            }, 300);

        };

        // Initialize view based on URL params
        window.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            if (params.get('type') === 'signup') {
                toggleAuth(true); // force signup view immediately (no animation needed on load really, but handles logic)
            }
        });

        window.togglePassword = function (inputId, btn) {
            const input = document.getElementById(inputId);
            const icon = btn.querySelector('.material-symbols-outlined');
            if (input.type === "password") {
                input.type = "text";
                icon.innerText = "visibility_off";
                icon.classList.add("text-primary");
            } else {
                input.type = "password";
                icon.innerText = "visibility";
                icon.classList.remove("text-primary");
            }
        };

        // --- AUTH API HANDLER ---
        async function sendTokenToBackend(user) {
            try {
                const token = await user.getIdToken();
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ idToken: token })
                });

                if (response.ok) {
                    showToast("Authentifizierung erfolgreich. Weiterleitung…", "success");
                    setTimeout(() => window.location.href = "/", 1000);
                } else {
                    throw new Error("Serverüberprüfung fehlgeschlagen");
                }
            } catch (error) {
                console.error(error);
                showToast("Serververbindung fehlgeschlagen. Bitte versuchen Sie es erneut.", "error");
            }
        }

        // --- EVENT LISTENERS ---

        // Email Signup
        document.getElementById('signup-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btnId = 'btn-signup-submit';
            const originalContent = document.getElementById(btnId).innerHTML;

            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const pass = document.getElementById('signup-pass').value;

            if (!name || !email || !pass) {
                showToast("Bitte füllen Sie alle Felder aus.");
                return;
            }

            setLoading(btnId, true);

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, pass);
                await updateProfile(userCredential.user, { displayName: name });
                await sendTokenToBackend(userCredential.user);
            } catch (error) {
                showToast(getFriendlyErrorMessage(error.code));
                setLoading(btnId, false, originalContent);
            }
        });

        // Email Login
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const btnId = 'btn-login-submit';
            const originalContent = document.getElementById(btnId).innerHTML;

            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-pass').value;

            if (!email || !pass) {
                showToast("Bitte geben Sie E-Mail-Adresse und Passwort ein.");
                return;
            }

            setLoading(btnId, true);

            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, pass);
                await sendTokenToBackend(userCredential.user);
            } catch (error) {
                showToast(getFriendlyErrorMessage(error.code));
                setLoading(btnId, false, originalContent);
            }
        });

        // Google
        document.getElementById('google-btn').addEventListener('click', async () => {
            try {
                const result = await signInWithPopup(auth, googleProvider);
                showToast("Google-Konto verifiziert.", "success");
                await sendTokenToBackend(result.user);
            } catch (error) {
                showToast(getFriendlyErrorMessage(error.code));
            }
        });

        // Apple
        document.getElementById('apple-btn').addEventListener('click', async () => {
            try {
                const result = await signInWithPopup(auth, appleProvider);
                showToast("Apple-Konto verifiziert.", "success");
                await sendTokenToBackend(result.user);
            } catch (error) {
                showToast(getFriendlyErrorMessage(error.code));
            }
        });


    </script>
</body>

</html>